## План

1) Изучить входные данные и утвердить маппинги
   - Поля: `shipping_country` как страна, `total` как сумма, количество покупок — суммарное количество проданных товаров: сумма `quantity` по строкам (товарным позициям) на страну.  
   - Фильтрация: учитывать только `fulfilled` в `fulfillment_status`; остальные статусы игнорировать.  
   - Валюта: USD.
   - Логировать шаг в `log_manifest.ai.md`.

2) Подготовить структуру кода
   - Файл: `excel_to_csv/code/process_shopify_orders.py`.  
   - Основные функции: загрузка Excel, фильтрация по статусу, расчет агрегатов, сортировка, сохранение CSV, построение интерактивной диаграммы (Plotly) в HTML.  
   - Логирование в `logs/` по правилам `log_manifest.ai.md`.  
   - Докстринги и комментарии с эмодзи.  
   - Логировать шаг в `log_manifest.ai.md`.

3) Реализация логики
   - Загрузка Excel и проверка необходимых колонок.  
   - Фильтрация `fulfillment_status == 'fulfilled'`.  
   - Группировка по `shipping_country`:  
     - `total_sales = sum(total)`  
     - `items_sold = sum(quantity)`  
   - Сортировка: по `total_sales` убыв., затем `items_sold` убыв., затем по стране.  
   - Взять топ-10 стран.  
   - Логировать шаг в `log_manifest.ai.md`.

4) Экспорт результатов
   - Сохранить CSV: `excel_to_csv/data_out/shopify_orders_20250929_202605.csv`.  
   - Сгенерировать интерактивную диаграмму в `excel_to_csv/data_out/diagram.html` (Plotly): подписи на русском, красивая тема.  
   - Логировать шаг в `log_manifest.ai.md`.

5) Тесты/проверки
   - Проверка наличия необходимых столбцов.  
   - Проверка корректности фильтрации по статусу.  
   - Проверка агрегатов на синтетических данных.  
   - Проверка успешного сохранения CSV и HTML.  
   - Логировать шаг в `log_manifest.ai.md`.

6) README (кратко)
   - Установка зависимостей (venv уже есть).  
   - Команда запуска.  
   - Описание выходов.  
   - Логировать шаг в `log_manifest.ai.md`.

## Аудит по prompt_auditor.md (кратко)
- Соблюдены требования по шагам, логированию, структуре и выходным артефактам.  
- Эмодзи/докстринги будут добавлены в код.  
- Используются бесплатные библиотеки: pandas, openpyxl, plotly.


